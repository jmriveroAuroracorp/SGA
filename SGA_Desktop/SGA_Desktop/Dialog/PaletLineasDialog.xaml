<Window x:Class="SGA_Desktop.Dialog.PaletLineasDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Añadir líneas al palet"
        Width="1000"
        Height="700"
        MinWidth="600"
        MinHeight="400"
        MaxWidth="1000"
        MaxHeight="700"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/SGA_Desktop;component/Resources/Estilos.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>

    <Border CornerRadius="8"
            Background="{StaticResource BrushFondo}"
            BorderBrush="{StaticResource BrushPrincipal}"
            BorderThickness="2"
            Padding="20">

        <DockPanel LastChildFill="True">

            <!-- CABECERA -->
            <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="0,0,0,10">
                <TextBlock Text="Palet: " Style="{StaticResource LabelStyle}" />
                <TextBlock Text="{Binding PaletCodigo}" Margin="5,0"/>
                <TextBlock Text="| Tipo: " Style="{StaticResource LabelStyle}" Margin="10,0"/>
                <TextBlock Text="{Binding PaletTipo}" Margin="5,0"/>
                <TextBlock Text="| Estado: " Style="{StaticResource LabelStyle}" Margin="10,0"/>
                <TextBlock Text="{Binding PaletEstado}" Margin="5,0"/>
            </StackPanel>

            <!-- BUSCADOR DE ARTÍCULO -->
            <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="0,0,0,10">
                <TextBlock Text="Artículo:" Style="{StaticResource LabelStyle}" VerticalAlignment="Center"/>
                <TextBox Width="150" Text="{Binding ArticuloBuscado}" Style="{StaticResource EstiloCajaTexto}" Margin="5,0"/>
                <Button Content="Buscar stock" Command="{Binding BuscarStockCommand}" Style="{StaticResource EstiloBotonPrincipal}" Margin="10,0"/>
            </StackPanel>

            <!-- CUERPO: DataGrid + Botón cerrar -->
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!-- DATAGRID CON SCROLL -->
                <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
                    <DataGrid ItemsSource="{Binding StockDisponible}"
                              AutoGenerateColumns="False"
                              MinWidth="500"
                              HeadersVisibility="Column"
                              CanUserAddRows="False"
                              Style="{StaticResource EstiloDataGrid}"
                              Margin="0,0,0,10">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Almacén" Binding="{Binding CodigoAlmacen}" Width="*" />
                            <DataGridTextColumn Header="Ubicación" Binding="{Binding Ubicacion}" Width="*" />
                            <DataGridTextColumn Header="Lote" Binding="{Binding Partida}" Width="*" />
                            <DataGridTextColumn Header="Caducidad" Binding="{Binding FechaCaducidad, StringFormat=d}" Width="*" />
                            <DataGridTextColumn Header="Disponible" Binding="{Binding UnidadSaldo}" Width="*" />
                            <DataGridTemplateColumn Header="Cantidad a mover" Width="120">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBox Width="80"
                                                 HorizontalAlignment="Center"
                                                 Text="{Binding CantidadAMover, UpdateSourceTrigger=PropertyChanged}" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Content="Añadir"
                                                Command="{Binding DataContext.AñadirLineaCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                                CommandParameter="{Binding}"
                                                Width="70"
                                                Style="{StaticResource EstiloBotonPrincipal}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </ScrollViewer>

                <!-- BOTÓN CERRAR -->
                <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                    <Button Content="Confirmar"
            Width="90"
            Margin="0,0,10,0"
            Command="{Binding ConfirmarCommand}"
            Style="{StaticResource EstiloBotonPrincipal}"/>
                    <Button Content="Cerrar"
                            Width="90"
                            IsCancel="True"
                            Style="{StaticResource EstiloBotonPrincipal}"/>
                </StackPanel>
            </Grid>

        </DockPanel>

    </Border>
</Window>
